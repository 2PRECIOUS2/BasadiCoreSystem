import{D as f,j as t,r as a,K as at,C as I,B as d,P as We,q as y,T as o}from"./index-7f2a5a5c.js";import{r as j}from"./createSvgIcon-7d212144.js";import{d as ot}from"./ShoppingCart-b7f601da.js";import{d as lt}from"./Add-d3225c7a.js";import{L as $e}from"./lodash-052838f0.js";import{L as it,b as c,I as U}from"./MenuItem-e27c57ab.js";import{L as qe}from"./ListSubheader-dc2aff66.js";import{T as l}from"./TextField-b5c10dbe.js";import{D as G}from"./Divider-f09bd367.js";import{M as nt}from"./ListItemIcon-e33201e7.js";import{M as dt}from"./ListItemText-44ba3285.js";import{T as ct}from"./TableContainer-44a88e8c.js";import{T as ut,a as ht,b as De,c as xt}from"./TableRow-0db546b8.js";import{T as C}from"./TableCell-c04f540f.js";import{S as ke}from"./Snackbar-095d4b37.js";import{A as R,F as mt,S as pt}from"./Select-d37c91fa.js";import{D as Ie}from"./Dialog-b4e01f51.js";import{S as Re}from"./Slide-81ab56a8.js";import{D as ze,a as Fe}from"./DialogTitle-28245c8f.js";import{S as Q}from"./Stack-c4449878.js";import{M as ft}from"./FormControlLabel-67927353.js";import{M as jt}from"./Checkbox-7d491049.js";import"./ClickAwayListener-abc824ad.js";import"./useThemeProps-9087c27b.js";var ee={},vt=f;Object.defineProperty(ee,"__esModule",{value:!0});var Le=ee.default=void 0,gt=vt(j()),yt=t;Le=ee.default=(0,gt.default)((0,yt.jsx)("path",{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20z"}),"ArrowBack");var te={},Ct=f;Object.defineProperty(te,"__esModule",{value:!0});var we=te.default=void 0,bt=Ct(j()),_t=t;we=te.default=(0,bt.default)((0,_t.jsx)("path",{d:"M19 13H5v-2h14z"}),"Remove");var re={},St=f;Object.defineProperty(re,"__esModule",{value:!0});var J=re.default=void 0,Pt=St(j()),At=t;J=re.default=(0,Pt.default)((0,At.jsx)("path",{d:"M11.8 10.9c-2.27-.59-3-1.2-3-2.15 0-1.09 1.01-1.85 2.7-1.85 1.78 0 2.44.85 2.5 2.1h2.21c-.07-1.72-1.12-3.3-3.21-3.81V3h-3v2.16c-1.94.42-3.5 1.68-3.5 3.61 0 2.31 1.91 3.46 4.7 4.13 2.5.6 3 1.48 3 2.41 0 .69-.49 1.79-2.7 1.79-2.06 0-2.87-.92-2.98-2.1h-2.2c.12 2.19 1.76 3.42 3.68 3.83V21h3v-2.15c1.95-.37 3.5-1.5 3.5-3.55 0-2.84-2.43-3.81-4.7-4.4"}),"AttachMoney");var se={},Mt=f;Object.defineProperty(se,"__esModule",{value:!0});var K=se.default=void 0,Tt=Mt(j()),Ot=t;K=se.default=(0,Tt.default)((0,Ot.jsx)("path",{d:"M20 4H4c-1.11 0-1.99.89-1.99 2L2 18c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V6c0-1.11-.89-2-2-2m0 14H4v-6h16zm0-10H4V6h16z"}),"CreditCard");var ae={},Wt=f;Object.defineProperty(ae,"__esModule",{value:!0});var Y=ae.default=void 0,$t=Wt(j()),qt=t;Y=ae.default=(0,$t.default)((0,qt.jsx)("path",{d:"M4 10h3v7H4zm6.5 0h3v7h-3zM2 19h20v3H2zm15-9h3v7h-3zm-5-9L2 6v2h20V6z"}),"AccountBalance");var oe={},Dt=f;Object.defineProperty(oe,"__esModule",{value:!0});var X=oe.default=void 0,kt=Dt(j()),It=t;X=oe.default=(0,kt.default)((0,It.jsx)("path",{d:"M16 1H8C6.34 1 5 2.34 5 4v16c0 1.66 1.34 3 3 3h8c1.66 0 3-1.34 3-3V4c0-1.66-1.34-3-3-3m-2 20h-4v-1h4zm3.25-3H6.75V4h10.5z"}),"PhoneAndroid");var le={},Rt=f;Object.defineProperty(le,"__esModule",{value:!0});var Ne=le.default=void 0,zt=Rt(j()),Z=t;Ne=le.default=(0,zt.default)([(0,Z.jsx)("path",{d:"m12 2-5.5 9h11z"},"0"),(0,Z.jsx)("circle",{cx:"17.5",cy:"17.5",r:"4.5"},"1"),(0,Z.jsx)("path",{d:"M3 13.5h8v8H3z"},"2")],"Category");var ie={},Ft=f;Object.defineProperty(ie,"__esModule",{value:!0});var He=ie.default=void 0,Lt=Ft(j()),wt=t;He=ie.default=(0,Lt.default)((0,wt.jsx)("path",{d:"m2.53 19.65 1.34.56v-9.03l-2.43 5.86c-.41 1.02.08 2.19 1.09 2.61m19.5-3.7L17.07 3.98c-.31-.75-1.04-1.21-1.81-1.23-.26 0-.53.04-.79.15L7.1 5.95c-.75.31-1.21 1.03-1.23 1.8-.01.27.04.54.15.8l4.96 11.97c.31.76 1.05 1.22 1.83 1.23.26 0 .52-.05.77-.15l7.36-3.05c1.02-.42 1.51-1.59 1.09-2.6M7.88 8.75c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1m-2 11c0 1.1.9 2 2 2h1.45l-3.45-8.34z"}),"Style");var ne={},Nt=f;Object.defineProperty(ne,"__esModule",{value:!0});var Ee=ne.default=void 0,Ht=Nt(j()),Et=t;Ee=ne.default=(0,Ht.default)((0,Et.jsx)("path",{d:"M21.6 18.2 13 11.75v-.91c1.65-.49 2.8-2.17 2.43-4.05-.26-1.31-1.3-2.4-2.61-2.7C10.54 3.57 8.5 5.3 8.5 7.5h2c0-.83.67-1.5 1.5-1.5s1.5.67 1.5 1.5c0 .84-.69 1.52-1.53 1.5-.54-.01-.97.45-.97.99v1.76L2.4 18.2c-.77.58-.36 1.8.6 1.8h18c.96 0 1.37-1.22.6-1.8M6 18l6-4.5 6 4.5z"}),"Checkroom");var de={},Bt=f;Object.defineProperty(de,"__esModule",{value:!0});var Be=de.default=void 0,Vt=Bt(j()),Ut=t;Be=de.default=(0,Vt.default)((0,Ut.jsx)("path",{d:"M20 6h-2.18c.11-.31.18-.65.18-1 0-1.66-1.34-3-3-3-1.05 0-1.96.54-2.5 1.35l-.5.67-.5-.68C10.96 2.54 10.05 2 9 2 7.34 2 6 3.34 6 5c0 .35.07.69.18 1H4c-1.11 0-1.99.89-1.99 2L2 19c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2m-5-2c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1M9 4c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1m11 15H4v-2h16zm0-5H4V8h5.08L7 10.83 8.62 12 11 8.76l1-1.36 1 1.36L15.38 12 17 10.83 14.92 8H20z"}),"CardGiftcard");const Gt=["All Products","Fashion Accessories","African print-inspired custom clothing","Corporate Gifts"],Qt=[{label:"Best Selling",value:"best"},{label:"Alphabetically, A-Z",value:"az"},{label:"Alphabetically, Z-A",value:"za"}],Zt=[{label:"Standard Order",value:"standard"},{label:"Project Order",value:"project"}],yr=()=>{const[Ve,M]=a.useState(!1),[T,O]=a.useState([]),ce=at(),[z,ue]=a.useState(""),[he,xe]=a.useState(""),[Ue,me]=a.useState(!1),[pe,fe]=a.useState(!1),[je,F]=a.useState(""),[x,W]=a.useState({category:"",sort:"",search:""}),[u,$]=a.useState({}),[Ge,q]=a.useState(!1),[ve,A]=a.useState(!1),[b,D]=a.useState([]),[ge,k]=a.useState(!0),[ye,Qe]=a.useState(null),[S,Ce]=a.useState(""),[h,Ze]=a.useState("standard"),[be,L]=a.useState([]),[w,_e]=a.useState("");a.useState("");const[N,Se]=a.useState(""),[H,Pe]=a.useState(""),[E,Ae]=a.useState(""),[m,_]=a.useState({streetAddress:"",city:"",stateProvince:"",postalCode:"",country:""}),[p,P]=a.useState({streetAddress:"",city:"",stateProvince:"",postalCode:"",country:""}),[v,Me]=a.useState(!0);a.useEffect(()=>{k(!0),fetch(`${I}/api/customers`,{credentials:"include"}).then(e=>e.json()).then(e=>{console.log("API data:",e),Array.isArray(e)?O(e):Array.isArray(e.data)?O(e.data):O([])}).catch(()=>O([])).finally(()=>k(!1)),fetch(`${I}/api/products`,{credentials:"include"}).then(e=>e.json()).then(e=>{Array.isArray(e)?D(e):Array.isArray(e.data)?D(e.data):D([]),k(!1)}).catch(()=>{D([]),k(!1),Qe("Failed to fetch products")}),fetch(`${I}/api/projects`,{credentials:"include"}).then(e=>e.json()).then(e=>{console.log("Projects data:",e),Array.isArray(e)?L(e):L([])}).catch(e=>{console.error("Failed to fetch projects:",e),L([])})},[]);const Je=b.filter(e=>{const r=!x.category||x.category==="All Products"||e.category===x.category,i=!x.search||e.product_name.toLowerCase().includes(x.search.toLowerCase());return r&&i}),B=(e,r)=>{W(i=>({...i,[e]:r}))},[V,Ke]=a.useState({}),Te=(e,r)=>{Ke(i=>{const n=(i[e]||0)+r;return{...i,[e]:n>0?n:0}})},Ye=e=>{$(r=>({...r,[e]:V[e]||1})),A(!0)},Xe=()=>{A(!1),q(!0)},et=()=>{q(!0)},Oe=()=>{q(!1)},[s,tt]=a.useState({}),rt=()=>{let e={};return h==="standard"?(S||(e.selectedCustomer="Please select a customer."),v||(m.streetAddress||(e.streetAddress="Street address is required."),m.city||(e.city="City is required."),m.stateProvince||(e.stateProvince="State/Province is required."),m.postalCode||(e.postalCode="Postal code is required."),m.country||(e.country="Country is required.")),z||(e.deliveryDate="Please pick a delivery date.")):(w||(e.selectedProject="Please select a project."),N||(e.projectCustomerFirstName="First name is required."),H||(e.projectCustomerLastName="Last name is required."),p.streetAddress||(e.projectStreetAddress="Street address is required."),p.city||(e.projectCity="City is required."),p.stateProvince||(e.projectStateProvince="State/Province is required."),p.postalCode||(e.projectPostalCode="Postal code is required."),p.country||(e.projectCountry="Country is required."),E||(e.orderDate="Please pick an order date.")),x.paymentMethod||(e.paymentMethod="Please select a payment method."),tt(e),Object.keys(e).length===0};return a.useEffect(()=>{if(S&&v&&h==="standard"){const e=T.find(r=>r.customerNumber.toString()===S);e&&_({streetAddress:e.streetAddress||"",city:e.city||"",stateProvince:e.stateProvince||"",postalCode:e.postalCode||"",country:e.country||""})}},[S,v,T,h]),t.jsxs(d,{sx:{display:"flex",height:"100vh",bgcolor:"#fafafa"},children:[t.jsx(We,{elevation:2,sx:{width:240,p:2,borderRadius:0,bgcolor:"#fff",minHeight:"100vh"},children:t.jsxs(it,{subheader:t.jsx(qe,{children:"Filters"}),children:[t.jsx($e,{children:t.jsx(l,{select:!0,label:"Sort By",value:x.sort,onChange:e=>B("sort",e.target.value),fullWidth:!0,size:"small",children:Qt.map(e=>t.jsx(c,{value:e.value,children:e.label},e.value))})}),t.jsx(G,{sx:{my:1}}),t.jsx(qe,{sx:{pl:0},children:"Categories"}),Gt.map(e=>t.jsxs($e,{button:!0,selected:x.category===e,onClick:()=>B("category",e),children:[t.jsxs(nt,{children:[e==="All Products"&&t.jsx(Ne,{sx:{color:"#1976d2"}}),e==="Fashion Accessories"&&t.jsx(He,{sx:{color:"#d81b60"}}),e==="African print-inspired custom clothing"&&t.jsx(Ee,{sx:{color:"#43a047"}}),e==="Corporate Gifts"&&t.jsx(Be,{sx:{color:"#fbc02d"}})]}),t.jsx(dt,{primary:e})]},e))]})}),t.jsxs(d,{sx:{flex:1,p:4},children:[t.jsxs(d,{sx:{display:"flex",alignItems:"center",mb:2},children:[t.jsx(y,{startIcon:t.jsx(Le,{}),onClick:()=>ce("/Orders"),sx:{textTransform:"none",fontWeight:700,fontSize:16,color:"primary.main",pl:0,mr:2},children:"Back"}),t.jsx(o,{variant:"h5",sx:{fontWeight:700,flex:1,textAlign:"center"},children:"Order Page"}),t.jsx(U,{color:"primary",sx:{ml:2,bgcolor:"#e3f2fd",borderRadius:2,p:1,boxShadow:1},onClick:et,children:t.jsx(ot,{sx:{fontSize:32}})})]}),t.jsx(d,{sx:{display:"flex",alignItems:"center",mb:2},children:t.jsx(l,{label:"Search products...",value:x.search,onChange:e=>B("search",e.target.value),size:"small",sx:{width:350}})}),ge?t.jsx(o,{children:"Loading products..."}):ye?t.jsx(o,{color:"error",children:ye}):t.jsx(ct,{component:We,elevation:1,sx:{borderRadius:2},children:t.jsxs(ut,{children:[t.jsx(ht,{children:t.jsxs(De,{children:[t.jsx(C,{children:"Product"}),t.jsx(C,{children:"Qty"}),t.jsx(C,{children:"Subtotal"}),t.jsx(C,{children:"Cart"})]})}),t.jsx(xt,{children:Je.map(e=>t.jsxs(De,{children:[t.jsx(C,{children:t.jsxs(d,{sx:{display:"flex",alignItems:"center"},children:[t.jsx(d,{component:"img",src:(()=>e.image_path&&e.image_path.startsWith("/images/products/")?`http://localhost:5000${e.image_path}`:"http://localhost:5000/images/products/placeholder.png")(),alt:e.product_name,sx:{width:48,height:48,objectFit:"cover",borderRadius:2,boxShadow:1,mr:2,bgcolor:"#f5f5f5",border:"1px solid #eee",display:"inline-block"},onError:r=>{r.target.onerror=null,r.target.src="http://localhost:5000/images/products/placeholder.png"}}),t.jsx(o,{sx:{fontWeight:500},children:e.product_name})]})}),t.jsx(C,{children:t.jsxs(d,{sx:{display:"flex",alignItems:"center"},children:[t.jsx(U,{size:"small",onClick:()=>Te(e.product_id,-1),children:t.jsx(we,{})}),t.jsx(o,{sx:{mx:1},children:V[e.product_id]||0}),t.jsx(U,{size:"small",onClick:()=>Te(e.product_id,1),children:t.jsx(lt,{})})]})}),t.jsxs(C,{children:["R",((V[e.product_id]||0)*e.selling_price).toFixed(2)]}),t.jsx(C,{children:t.jsx(y,{variant:"contained",color:"primary",onClick:()=>Ye(e.product_id),children:"Add to cart"})})]},e.product_id))})]})}),t.jsx(ke,{open:ve,autoHideDuration:2e3,onClose:()=>A(!1),anchorOrigin:{vertical:"bottom",horizontal:"center"},children:t.jsx(R,{severity:"success",sx:{width:"100%"},action:t.jsx(y,{color:"inherit",size:"small",onClick:Xe,children:"Go to Cart"}),children:"Product added to cart"})}),t.jsxs(Ie,{open:Ge,onClose:Oe,fullScreen:!0,TransitionComponent:Re,TransitionProps:{direction:"up"},children:[t.jsxs(ze,{sx:{display:"flex",alignItems:"center",minHeight:56},children:[t.jsx(y,{startIcon:t.jsx("span",{style:{fontSize:20,fontWeight:700},children:"<"}),onClick:Oe,sx:{textTransform:"none",fontWeight:700,fontSize:16,color:"primary.main",pl:0},children:"Back"}),t.jsx(o,{variant:"h6",sx:{flex:1,textAlign:"center",fontWeight:700},children:"Cart"})]}),t.jsx(Fe,{dividers:!0,sx:{bgcolor:"#fafafa"},children:t.jsxs(d,{sx:{maxWidth:600,mx:"auto",mt:2},children:[t.jsx(o,{variant:"h6",sx:{mb:2,fontWeight:700},children:"Your Cart"}),Object.keys(u).length===0||Object.values(u).every(e=>e===0)?t.jsx(o,{children:"No items in cart."}):t.jsxs(Q,{spacing:3,children:[b.filter(e=>u[e.product_id]>0).map(e=>{const r=e.quantity,i=u[e.product_id];return t.jsxs(d,{sx:{display:"flex",alignItems:"center",bgcolor:"#fff",borderRadius:3,boxShadow:1,p:2},children:[t.jsx(d,{component:"img",src:e.image_path&&e.image_path.startsWith("/images/products/")?`http://localhost:5000${e.image_path}`:"http://localhost:5000/images/products/placeholder.png",alt:e.product_name,sx:{width:80,height:80,objectFit:"cover",borderRadius:2,mr:3,border:"1px solid #eee",bgcolor:"#f5f5f5"},onError:n=>{n.target.onerror=null,n.target.src="http://localhost:5000/images/products/placeholder.png"}}),t.jsxs(d,{sx:{flex:1},children:[t.jsx(o,{variant:"subtitle1",sx:{fontWeight:600},children:e.product_name}),t.jsx(o,{variant:"body2",sx:{color:"text.secondary",mb:1},children:e.category}),t.jsx(mt,{size:"small",sx:{minWidth:80},children:t.jsx(pt,{value:i,onChange:n=>{const g=n.target.value;g<=r&&$(st=>({...st,[e.product_id]:g}))},children:Array.from({length:r},(n,g)=>g+1).map(n=>t.jsx(c,{value:n,children:n},n))})}),t.jsx(o,{variant:"body2",sx:{mt:1,color:r>0?"green":"red"},children:r>0?`${r} in stock`:"Out of Stock"})]}),t.jsxs(o,{variant:"h6",sx:{fontWeight:700,minWidth:80,textAlign:"right",mr:2},children:["R",(i*e.selling_price).toFixed(2)]}),t.jsx(y,{color:"error",variant:"outlined",size:"small",onClick:()=>$(n=>{const g={...n};return delete g[e.product_id],g}),children:"Remove"})]},e.product_id)}),t.jsxs(d,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mt:2},children:[t.jsxs(o,{variant:"h6",sx:{fontWeight:700},children:["Total: (",Object.values(u).reduce((e,r)=>e+r,0)," Items)"]}),t.jsxs(o,{variant:"h5",sx:{fontWeight:700,color:"primary.main"},children:["R",b.reduce((e,r)=>e+(u[r.product_id]||0)*r.selling_price,0).toFixed(2)]})]}),(()=>{const e=b.some(r=>u[r.product_id]>0&&u[r.product_id]>r.quantity);return t.jsxs(t.Fragment,{children:[t.jsx(y,{variant:"contained",color:"primary",size:"large",sx:{mt:2,borderRadius:2,fontWeight:700},onClick:()=>M(!0),disabled:e,children:"Proceed to Checkout"}),e&&t.jsx(o,{color:"error",sx:{mt:1,fontWeight:600},children:"Please adjust your cart — some items are out of stock."})]})})(),t.jsxs(Ie,{open:Ve,onClose:()=>M(!1),fullScreen:!0,TransitionComponent:Re,TransitionProps:{direction:"up"},children:[t.jsxs(ze,{sx:{display:"flex",alignItems:"center",minHeight:56},children:[t.jsx(y,{startIcon:t.jsx("span",{style:{fontSize:20,fontWeight:700},children:"<"}),onClick:()=>M(!1),sx:{textTransform:"none",fontWeight:700,fontSize:16,color:"primary.main",pl:0},children:"Back"}),t.jsx(o,{variant:"h6",sx:{flex:1,textAlign:"center",fontWeight:700},children:"Order Details"})]}),t.jsx(Fe,{dividers:!0,sx:{bgcolor:"#fafafa"},children:t.jsxs(d,{sx:{maxWidth:600,mx:"auto",mt:2},children:[t.jsx(o,{variant:"h6",sx:{mb:2,fontWeight:700},children:"Order Details"}),t.jsxs(Q,{spacing:3,children:[t.jsx(l,{select:!0,label:"Order Type",value:h,onChange:e=>Ze(e.target.value),fullWidth:!0,sx:{mb:2},children:Zt.map(e=>t.jsx(c,{value:e.value,children:e.label},e.value))}),h==="project"&&t.jsx(l,{select:!0,label:"Select Project",value:w,onChange:e=>_e(e.target.value),fullWidth:!0,required:!0,error:!!s.selectedProject,helperText:s.selectedProject,sx:{mb:2},children:be.length>0?be.map(e=>t.jsxs(c,{value:e.id,children:[e.title," - ",e.category]},e.id)):t.jsx(c,{disabled:!0,children:"No projects found"})}),h==="standard"?t.jsxs(t.Fragment,{children:[t.jsx(l,{select:!0,label:"Select Customer",value:S,onChange:e=>Ce(e.target.value),fullWidth:!0,required:!0,error:!!s.selectedCustomer,helperText:s.selectedCustomer,children:ge?t.jsx(c,{disabled:!0,children:"Loading..."}):T.length>0?T.map(e=>t.jsx(c,{value:e.customerNumber.toString(),children:`${e.firstName} ${e.lastName}, ${e.email}`},e.customerNumber)):t.jsx(c,{disabled:!0,children:"No customers found"})}),t.jsxs(l,{select:!0,label:"Payment Method",value:x.paymentMethod||"",onChange:e=>W(r=>({...r,paymentMethod:e.target.value})),fullWidth:!0,required:!0,error:!!s.paymentMethod,helperText:s.paymentMethod,children:[t.jsxs(c,{value:"Cash",children:[t.jsx(J,{sx:{mr:1}})," Cash On Delivery"]}),t.jsxs(c,{value:"Card",children:[t.jsx(K,{sx:{mr:1}})," Credit and Debit Card"]}),t.jsxs(c,{value:"EFT",children:[t.jsx(Y,{sx:{mr:1}})," EFT"]}),t.jsxs(c,{value:"Mobile Money",children:[t.jsx(X,{sx:{mr:1}})," Mobile Money"]})]}),t.jsx(ft,{control:t.jsx(jt,{checked:v,onChange:e=>Me(e.target.checked)}),label:"Use customer's saved address",sx:{mb:2}}),t.jsx(l,{label:"Street Address",value:m.streetAddress,onChange:e=>_(r=>({...r,streetAddress:e.target.value})),fullWidth:!0,required:!0,disabled:v,error:!!s.streetAddress,helperText:s.streetAddress}),t.jsx(l,{label:"City",value:m.city,onChange:e=>_(r=>({...r,city:e.target.value})),fullWidth:!0,required:!0,disabled:v,error:!!s.city,helperText:s.city}),t.jsx(l,{label:"State / Province",value:m.stateProvince,onChange:e=>_(r=>({...r,stateProvince:e.target.value})),fullWidth:!0,required:!0,disabled:v,error:!!s.stateProvince,helperText:s.stateProvince}),t.jsx(l,{label:"Postal Code",value:m.postalCode,onChange:e=>_(r=>({...r,postalCode:e.target.value})),fullWidth:!0,required:!0,disabled:v,error:!!s.postalCode,helperText:s.postalCode}),t.jsx(l,{label:"Country",value:m.country,onChange:e=>_(r=>({...r,country:e.target.value})),fullWidth:!0,required:!0,disabled:v,error:!!s.country,helperText:s.country}),t.jsx(l,{label:"Delivery Date",type:"date",value:z,onChange:e=>ue(e.target.value),InputLabelProps:{shrink:!0},fullWidth:!0,required:!0,error:!!s.deliveryDate,helperText:s.deliveryDate})]}):t.jsxs(t.Fragment,{children:[t.jsx(l,{label:"First Name",value:N,onChange:e=>Se(e.target.value),fullWidth:!0,required:!0,error:!!s.projectCustomerFirstName,helperText:s.projectCustomerFirstName,sx:{mb:2}}),t.jsx(l,{label:"Last Name",value:H,onChange:e=>Pe(e.target.value),fullWidth:!0,required:!0,error:!!s.projectCustomerLastName,helperText:s.projectCustomerLastName,sx:{mb:2}}),t.jsxs(l,{select:!0,label:"Payment Method",value:x.paymentMethod||"",onChange:e=>W(r=>({...r,paymentMethod:e.target.value})),fullWidth:!0,required:!0,error:!!s.paymentMethod,helperText:s.paymentMethod,children:[t.jsxs(c,{value:"Cash",children:[t.jsx(J,{sx:{mr:1}})," Cash On Delivery"]}),t.jsxs(c,{value:"Card",children:[t.jsx(K,{sx:{mr:1}})," Credit and Debit Card"]}),t.jsxs(c,{value:"EFT",children:[t.jsx(Y,{sx:{mr:1}})," EFT"]}),t.jsxs(c,{value:"Mobile Money",children:[t.jsx(X,{sx:{mr:1}})," Mobile Money"]})]}),t.jsx(l,{label:"Street Address",value:p.streetAddress,onChange:e=>P(r=>({...r,streetAddress:e.target.value})),fullWidth:!0,required:!0,error:!!s.projectStreetAddress,helperText:s.projectStreetAddress}),t.jsx(l,{label:"City",value:p.city,onChange:e=>P(r=>({...r,city:e.target.value})),fullWidth:!0,required:!0,error:!!s.projectCity,helperText:s.projectCity}),t.jsx(l,{label:"State / Province",value:p.stateProvince,onChange:e=>P(r=>({...r,stateProvince:e.target.value})),fullWidth:!0,required:!0,error:!!s.projectStateProvince,helperText:s.projectStateProvince}),t.jsx(l,{label:"Postal Code",value:p.postalCode,onChange:e=>P(r=>({...r,postalCode:e.target.value})),fullWidth:!0,required:!0,error:!!s.projectPostalCode,helperText:s.projectPostalCode}),t.jsx(l,{label:"Country",value:p.country,onChange:e=>P(r=>({...r,country:e.target.value})),fullWidth:!0,required:!0,error:!!s.projectCountry,helperText:s.projectCountry}),t.jsx(l,{label:"Order Date",type:"date",value:E,onChange:e=>Ae(e.target.value),InputLabelProps:{shrink:!0},fullWidth:!0,required:!0,error:!!s.orderDate,helperText:s.orderDate})]}),t.jsx(l,{label:"Comment (optional)",value:he,onChange:e=>xe(e.target.value),fullWidth:!0,multiline:!0,minRows:2}),t.jsx(G,{}),t.jsx(o,{variant:"h6",sx:{fontWeight:700},children:"Order Summary"}),t.jsx(Q,{spacing:2,children:b.filter(e=>u[e.product_id]>0).map(e=>t.jsxs(d,{sx:{display:"flex",alignItems:"center",bgcolor:"#fff",borderRadius:3,boxShadow:1,p:2},children:[t.jsx(d,{component:"img",src:(()=>e.image_path&&e.image_path.startsWith("/images/products/")?`http://localhost:5000${e.image_path}`:"http://localhost:5000/images/products/placeholder.png")(),alt:e.product_name,sx:{width:64,height:64,objectFit:"cover",borderRadius:2,mr:3,border:"1px solid #eee",bgcolor:"#f5f5f5"},onError:r=>{r.target.onerror=null,r.target.src="http://localhost:5000/images/products/placeholder.png"}}),t.jsxs(d,{sx:{flex:1},children:[t.jsx(o,{variant:"subtitle1",sx:{fontWeight:600},children:e.product_name}),t.jsx(o,{variant:"body2",sx:{color:"text.secondary",mb:1},children:e.category}),t.jsxs(o,{variant:"body2",sx:{color:"text.secondary"},children:["Qty: ",u[e.product_id]]})]}),t.jsxs(o,{variant:"h6",sx:{fontWeight:700,minWidth:80,textAlign:"right"},children:["R",(u[e.product_id]*e.selling_price).toFixed(2)]})]},e.product_id))}),t.jsx(G,{}),t.jsxs(d,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mt:2},children:[t.jsxs(o,{variant:"h6",sx:{fontWeight:700},children:["Total: (",Object.values(u).reduce((e,r)=>e+r,0)," Items)"]}),t.jsxs(o,{variant:"h5",sx:{fontWeight:700,color:"primary.main"},children:["R",b.reduce((e,r)=>e+(u[r.product_id]||0)*r.selling_price,0).toFixed(2)]})]}),t.jsx(y,{variant:"contained",color:"primary",size:"large",sx:{mt:2,borderRadius:2,fontWeight:700},disabled:Ue,onClick:async()=>{if(!rt())return;me(!0),F(""),fe(!1);const e=b.filter(i=>u[i.product_id]>0).map(i=>({product_id:i.product_id,quantity:u[i.product_id],unit_price:i.selling_price})),r={cust_id:h==="standard"?S:null,payment_method:x.paymentMethod,delivery_address:h==="standard"?m:null,delivery_date:h==="standard"?z:"",comment:he,items:e,order_type:h,project_address:h==="project"?p:null,cust_fname:h==="project"?N:null,cust_lname:h==="project"?H:null,order_date:h==="project"?E:null,project_id:h==="project"?w:null};try{const i=await fetch(`${I}/api/orders`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(r)}),n=await i.json();i.ok&&n.success?(fe(!0),A(!0),Ce(""),_e(""),Se(""),Pe(""),W(g=>({...g,paymentMethod:""})),Me(!0),_({streetAddress:"",city:"",stateProvince:"",postalCode:"",country:""}),P({streetAddress:"",city:"",stateProvince:"",postalCode:"",country:""}),ue(""),Ae(""),xe(""),$({}),M(!1),q(!1),setTimeout(()=>{ce("/Orders",{replace:!0})},2e3)):F(n.message||"Failed to submit order")}catch{F("Network error")}me(!1)},children:"Submit Order"}),pe&&t.jsx(R,{severity:"success",sx:{mt:2},children:"Order created successfully!"}),je&&t.jsx(R,{severity:"error",sx:{mt:2},children:je})]})]})})]})]})]})})]}),t.jsx(ke,{open:ve&&pe,autoHideDuration:3e3,onClose:()=>A(!1),anchorOrigin:{vertical:"top",horizontal:"center"},children:t.jsx(R,{severity:"success",sx:{width:"100%"},children:"Order created successfully! Redirecting to orders list..."})})]})]})};export{yr as default};
