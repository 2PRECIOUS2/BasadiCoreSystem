import{A as Y,j as e,K as Z,r as t,B as P,T as i,q as ee,C as te,L as se}from"./index-7f2a5a5c.js";import{P as re}from"./PageContainer-5b987cfc.js";import{L as oe}from"./Logo-9a4ad21a.js";import{S as O}from"./Stack-c4449878.js";import{F as u,I as m,S as ie,a as p,O as L,A as F}from"./Select-d37c91fa.js";import{b as q,I as ae}from"./MenuItem-e27c57ab.js";import{M as ne}from"./InputAdornment-c8da3a91.js";import{V as le}from"./Visibility-46fbeaf7.js";import{C as de}from"./CircularProgress-1de20e04.js";import{G as N,C as ce}from"./Grid-bb9fb0fd.js";import"./index-b8c9c791.js";import"./index-40b498ea.js";import"./useThemeProps-9087c27b.js";const ue=Y(e.jsx("path",{d:"M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74 7.13 11.35 7 12 7M2 4.27l2.28 2.28.46.46C3.08 8.3 1.78 10.02 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 0-.79.2-1.53.53-2.2m4.31-.78 3.15 3.15.02-.16c0-1.66-1.34-3-3-3z"}),"VisibilityOff"),me=({title:a,subtitle:h,subtext:g,setIsAuthenticated:T,setUser:k})=>{const z=Z(),[r,_]=t.useState(""),[n,V]=t.useState(""),[x,R]=t.useState(""),[l,G]=t.useState(""),[y,J]=t.useState(!1),[A,f]=t.useState(!1),[W,j]=t.useState(""),[$,D]=t.useState(!1),[H,K]=t.useState(""),[S,M]=t.useState(""),[b,E]=t.useState(""),[I,v]=t.useState(""),[w,B]=t.useState(""),U=async s=>{s.preventDefault(),f(!0),j(""),D(!1),M(""),E(""),v(""),B("");let o=!1;if(r||(M("Please select a login type"),o=!0),n?/\S+@\S+\.\S+/.test(n)||(E("Email is invalid"),o=!0):(E("Email is required"),o=!0),r==="super_admin"&&!x&&(B("Password is required"),o=!0),r==="employee"&&!l?(v("Employee ID is required"),o=!0):r==="employee"&&isNaN(l)&&(v("Employee ID must be a number"),o=!0),o){f(!1);return}try{const d={loginType:r,email:n.toLowerCase().trim(),...r==="super_admin"&&{password:x},...r==="employee"&&{employeeId:Number(l)}};console.log("ðŸ§¾ Sending login request:",d);const C=await fetch(`${te}/api/login`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(d)}),c=await C.json();C.ok?(D(!0),K("Login successful!"),localStorage.setItem("user",JSON.stringify(c.user)),localStorage.setItem("isAuthenticated","true"),localStorage.setItem("sessionId",c.sessionId),T&&T(!0),k&&k(c.user),setTimeout(()=>z("/dashboard"),1200)):j(c.message||`Login failed (Status: ${C.status})`)}catch(d){console.error("Login error:",d),j("Failed to connect to server. Please check your connection and try again.")}finally{f(!1)}},Q=()=>{J(!y)},X=s=>{s.preventDefault()};return e.jsxs(e.Fragment,{children:[a&&e.jsxs(P,{mb:2,children:[e.jsx(i,{fontWeight:"700",variant:"h2",mb:1,children:a}),g&&e.jsx(i,{variant:"subtitle1",color:"textSecondary",children:g})]}),g,e.jsxs(O,{spacing:3,sx:{mt:2},children:[e.jsxs(u,{fullWidth:!0,error:!!S,children:[e.jsx(m,{children:"Login Type"}),e.jsxs(ie,{value:r,label:"Login Type",onChange:s=>_(s.target.value),children:[e.jsx(q,{value:"employee",children:"Employee Login"}),e.jsx(q,{value:"super_admin",children:"Super Admin Login"})]}),S&&e.jsx(p,{children:S})]}),e.jsxs(u,{fullWidth:!0,error:!!b,children:[e.jsx(m,{htmlFor:"email",children:"Email"}),e.jsx(L,{id:"email",type:"email",value:n,onChange:s=>V(s.target.value),label:"Email",placeholder:"Enter your email"}),b&&e.jsx(p,{children:b})]}),r==="employee"&&e.jsxs(u,{fullWidth:!0,error:!!I,children:[e.jsx(m,{htmlFor:"employeeId",children:"Employee ID"}),e.jsx(L,{id:"employeeId",type:"number",value:l,onChange:s=>G(s.target.value),label:"Employee ID",placeholder:"Enter your Employee ID"}),I&&e.jsx(p,{children:I})]}),r==="super_admin"&&e.jsxs(u,{fullWidth:!0,error:!!w,children:[e.jsx(m,{htmlFor:"password",children:"Password"}),e.jsx(L,{id:"password",type:y?"text":"password",value:x,onChange:s=>R(s.target.value),label:"Password",placeholder:"Enter your password",endAdornment:e.jsx(ne,{position:"end",children:e.jsx(ae,{"aria-label":"toggle password visibility",onClick:Q,onMouseDown:X,edge:"end",children:y?e.jsx(ue,{}):e.jsx(le,{})})})}),w&&e.jsx(p,{children:w})]}),W&&e.jsx(F,{severity:"error",sx:{mt:2},children:W}),$&&e.jsx(F,{severity:"success",sx:{mt:2},children:H}),e.jsx(ee,{color:"primary",variant:"contained",size:"large",fullWidth:!0,type:"submit",onClick:U,disabled:A,sx:{py:1.5,fontWeight:"bold",background:"linear-gradient(45deg, #667eea, #764ba2)","&:hover":{background:"linear-gradient(45deg, #5a67d8, #667eea)"}},children:A?e.jsx(de,{size:24,color:"inherit"}):"Sign In"})]}),h]})},Ce=({setIsAuthenticated:a,setUser:h})=>e.jsx(re,{title:"Login",description:"this is Login page",children:e.jsx(P,{sx:{position:"relative","&:before":{content:'""',background:"radial-gradient(#d2f1df, #d3d7fa, #bad8f4)",backgroundSize:"400% 400%",animation:"gradient 15s ease infinite",position:"absolute",height:"100%",width:"100%",opacity:"0.3"}},children:e.jsx(N,{container:!0,spacing:0,justifyContent:"center",sx:{height:"100vh"},children:e.jsx(N,{item:!0,xs:12,sm:12,lg:4,xl:3,display:"flex",justifyContent:"center",alignItems:"center",children:e.jsxs(ce,{elevation:9,sx:{p:4,zIndex:1,width:"100%",maxWidth:"500px"},children:[e.jsx(P,{display:"flex",alignItems:"center",justifyContent:"center",children:e.jsx(oe,{})}),e.jsx(me,{setIsAuthenticated:a,setUser:h,subtext:e.jsx(i,{variant:"subtitle1",textAlign:"center",color:"textSecondary",mb:1,children:"Empower Women. Buy Local."}),subtitle:e.jsxs(O,{direction:"row",spacing:1,justifyContent:"center",mt:3,children:[e.jsx(i,{color:"textSecondary",variant:"body1",fontWeight:"500",children:"New to BasadiCore?"}),e.jsx(i,{component:se,to:"/auth/register",variant:"body1",fontWeight:"500",sx:{textDecoration:"none",color:"primary.main",ml:1,cursor:"pointer"},children:"Request Access"})]})})]})})})})});export{Ce as default};
