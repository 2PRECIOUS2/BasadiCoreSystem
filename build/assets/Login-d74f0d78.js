import{j as e,B as P,f as a,s as _,F as u,a9 as m,t as Y,M as N,ay as p,az as C,$ as Z,I as ee,aA as se,aB as te,A as q,e as re,a8 as oe,a0 as M,a1 as ae}from"./mui-051d3b2b.js";import{r as s}from"./vendor-0625b040.js";import{e as ie,A as ne,L as le}from"./index-06d060e6.js";import{P as de}from"./PageContainer-a391e3ef.js";import{L as ce}from"./Logo-23c69e48.js";import"./utils-f1b31201.js";import"./index-2a8f5de9.js";const ue=({title:i,subtitle:h,subtext:g,setIsAuthenticated:A,setUser:k})=>{const z=ie(),[r,O]=s.useState(""),[n,R]=s.useState(""),[x,$]=s.useState(""),[l,J]=s.useState(""),[y,V]=s.useState(!1),[T,f]=s.useState(!1),[W,j]=s.useState(""),[G,D]=s.useState(!1),[H,U]=s.useState(""),[S,B]=s.useState(""),[b,E]=s.useState(""),[w,v]=s.useState(""),[I,F]=s.useState(""),K=async t=>{t.preventDefault(),f(!0),j(""),D(!1),B(""),E(""),v(""),F("");let o=!1;if(r||(B("Please select a login type"),o=!0),n?/\S+@\S+\.\S+/.test(n)||(E("Email is invalid"),o=!0):(E("Email is required"),o=!0),r==="super_admin"&&!x&&(F("Password is required"),o=!0),r==="employee"&&!l?(v("Employee ID is required"),o=!0):r==="employee"&&isNaN(l)&&(v("Employee ID must be a number"),o=!0),o){f(!1);return}try{const d={loginType:r,email:n.toLowerCase().trim(),...r==="super_admin"&&{password:x},...r==="employee"&&{employeeId:Number(l)}};console.log("ðŸ§¾ Sending login request:",d);const L=await fetch(`${ne}/api/login`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(d)}),c=await L.json();L.ok?(D(!0),U("Login successful!"),localStorage.setItem("user",JSON.stringify(c.user)),localStorage.setItem("isAuthenticated","true"),localStorage.setItem("sessionId",c.sessionId),A&&A(!0),k&&k(c.user),setTimeout(()=>z("/dashboard"),1200)):j(c.message||`Login failed (Status: ${L.status})`)}catch(d){console.error("Login error:",d),j("Failed to connect to server. Please check your connection and try again.")}finally{f(!1)}},Q=()=>{V(!y)},X=t=>{t.preventDefault()};return e.jsxs(e.Fragment,{children:[i&&e.jsxs(P,{mb:2,children:[e.jsx(a,{fontWeight:"700",variant:"h2",mb:1,children:i}),g&&e.jsx(a,{variant:"subtitle1",color:"textSecondary",children:g})]}),g,e.jsxs(_,{spacing:3,sx:{mt:2},children:[e.jsxs(u,{fullWidth:!0,error:!!S,children:[e.jsx(m,{children:"Login Type"}),e.jsxs(Y,{value:r,label:"Login Type",onChange:t=>O(t.target.value),children:[e.jsx(N,{value:"employee",children:"Employee Login"}),e.jsx(N,{value:"super_admin",children:"Super Admin Login"})]}),S&&e.jsx(p,{children:S})]}),e.jsxs(u,{fullWidth:!0,error:!!b,children:[e.jsx(m,{htmlFor:"email",children:"Email"}),e.jsx(C,{id:"email",type:"email",value:n,onChange:t=>R(t.target.value),label:"Email",placeholder:"Enter your email"}),b&&e.jsx(p,{children:b})]}),r==="employee"&&e.jsxs(u,{fullWidth:!0,error:!!w,children:[e.jsx(m,{htmlFor:"employeeId",children:"Employee ID"}),e.jsx(C,{id:"employeeId",type:"number",value:l,onChange:t=>J(t.target.value),label:"Employee ID",placeholder:"Enter your Employee ID"}),w&&e.jsx(p,{children:w})]}),r==="super_admin"&&e.jsxs(u,{fullWidth:!0,error:!!I,children:[e.jsx(m,{htmlFor:"password",children:"Password"}),e.jsx(C,{id:"password",type:y?"text":"password",value:x,onChange:t=>$(t.target.value),label:"Password",placeholder:"Enter your password",endAdornment:e.jsx(Z,{position:"end",children:e.jsx(ee,{"aria-label":"toggle password visibility",onClick:Q,onMouseDown:X,edge:"end",children:y?e.jsx(se,{}):e.jsx(te,{})})})}),I&&e.jsx(p,{children:I})]}),W&&e.jsx(q,{severity:"error",sx:{mt:2},children:W}),G&&e.jsx(q,{severity:"success",sx:{mt:2},children:H}),e.jsx(re,{color:"primary",variant:"contained",size:"large",fullWidth:!0,type:"submit",onClick:K,disabled:T,sx:{py:1.5,fontWeight:"bold",background:"linear-gradient(45deg, #667eea, #764ba2)","&:hover":{background:"linear-gradient(45deg, #5a67d8, #667eea)"}},children:T?e.jsx(oe,{size:24,color:"inherit"}):"Sign In"})]}),h]})},je=({setIsAuthenticated:i,setUser:h})=>e.jsx(de,{title:"Login",description:"this is Login page",children:e.jsx(P,{sx:{position:"relative","&:before":{content:'""',background:"radial-gradient(#d2f1df, #d3d7fa, #bad8f4)",backgroundSize:"400% 400%",animation:"gradient 15s ease infinite",position:"absolute",height:"100%",width:"100%",opacity:"0.3"}},children:e.jsx(M,{container:!0,spacing:0,justifyContent:"center",sx:{height:"100vh"},children:e.jsx(M,{item:!0,xs:12,sm:12,lg:4,xl:3,display:"flex",justifyContent:"center",alignItems:"center",children:e.jsxs(ae,{elevation:9,sx:{p:4,zIndex:1,width:"100%",maxWidth:"500px"},children:[e.jsx(P,{display:"flex",alignItems:"center",justifyContent:"center",children:e.jsx(ce,{})}),e.jsx(ue,{setIsAuthenticated:i,setUser:h,subtext:e.jsx(a,{variant:"subtitle1",textAlign:"center",color:"textSecondary",mb:1,children:"Empower Women. Buy Local."}),subtitle:e.jsxs(_,{direction:"row",spacing:1,justifyContent:"center",mt:3,children:[e.jsx(a,{color:"textSecondary",variant:"body1",fontWeight:"500",children:"New to BasadiCore?"}),e.jsx(a,{component:le,to:"/auth/register",variant:"body1",fontWeight:"500",sx:{textDecoration:"none",color:"primary.main",ml:1,cursor:"pointer"},children:"Request Access"})]})})]})})})})});export{je as default};
